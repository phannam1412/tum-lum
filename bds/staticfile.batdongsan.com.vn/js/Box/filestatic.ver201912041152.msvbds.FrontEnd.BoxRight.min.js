var cm=new CommonJS.Common,captcha=new CaptchaJS.CommonCaptcha,newsLetterRegister={};(function(n){n.NewsLetterRegister=function(){function o(){cm.GetCurrentUserInfo(function(t){t!=null&&(u=t.mobile!==""&&t.mobile!=undefined&&t.mobile!=null?t.mobile:"",r=t.name!==""&&t.name!=undefined&&t.name!=null?t.name:"",n=t.email!==""&&t.email!=undefined&&t.email!=null?t.email:"")});$("#newsletterRegister").click(function(){n=$("#email").val();c(n,r,u)});$("#btnSend").click(function(){var n=$("#txtContent").val(),t=$("#hdCate").val(),i=$("#hdSubCate").val();n!==undefined&&n!==""?(window.localStorage.setItem("FAQQuestion",n),window.localStorage.setItem("FAQCate",t),window.localStorage.setItem("FAQSubCate",i),window.location.href="/dang-tin-hoi-dap"):(window.localStorage.removeItem("FAQQuestion"),window.localStorage.removeItem("FAQCate",t),window.localStorage.removeItem("FAQSubCate",i),alert("Bạn vui lòng nhập nội dung câu hỏi"))})}function s(){var t;if(captcha.GetCaptcha("secodeRegister","hddSecodeRegister"),$("#reloadCaptchaRegister").click(),$("#reloadCaptchaRegister").click(function(){captcha.GetCaptcha("secodeRegister","hddSecodeRegister")}),n=$("#Email").val(),t=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,n!==undefined&&n!==""&&t.test(n)&&e(n),$("#Email").blur(function(){n=$(this).val();n!==undefined&&n!==""&&t.test(n)&&e(n)}),$("#checkSms").click(function(){var n=$(this).attr("data-check");n==="1"?($("#checkSms input").val(!1),$("#checkSms").removeClass("selected"),$("#checkSms").attr("data-check",0)):($("#checkSms input").val(!0),$("#checkSms").addClass("selected"),$("#checkSms").attr("data-check",1))}),$(".checkCate").click(function(){var n=$(this).data("id"),i=$(this).attr("data-check"),t=$("#listCateId").val();i==="1"?($(this).removeClass("selected"),$(this).attr("data-check",0),$("#listCateId").val(t.replace(n+";",""))):($(this).addClass("selected"),$(this).attr("data-check",1),$("#listCateId").val(t+n+";"))}),getCookie("userinfo")!==undefined&&getCookie("userinfo")!=""&&getCookie("userinfo")!=null&&getCookie("userinfo")!="null"){var i=$("#staticDomain").data("content"),r=i+baseUrlPersonal+"/Accounts/Home/GetUserInfo",u=new CommonJS.Common,f={type:"GET",dataType:"json",url:r,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(n){n!==undefined&&n!=null&&($("#Email").val(n.email),$("#FullName").val(n.name),$("#Mobile").val(n.mobile))},error:function(){}};u.AjaxWrapper(f)}}function h(){var n=$("#Confirm").data("value"),r,u;n=="1"||n==1?($(".modal-footer button").css("display","none"),$(".modal-footer").css("margin-top","-45px")):(t="",r={style:"static",classClose:"fancybox-item fancybox-close new2019",classContent:"new2019",classHeader:"newsletter-register new2019",classFooter:"col center new2019",title:'<div class="news-text"><div class="logo"><a rel="nofollow" href="https://batdongsan.com.vn"><img alt="Kênh thông tin mua bán, cho thuê nhà đất số 1" src=" '+i+'/images/logo-enews1.jpg"><\/a><\/div><\/div> <div class="clear">&nbsp;<\/div>',width:660,height:320,content:'<div id="success">Cảm ơn bạn đã đăng ký nhận Email.Chúng tôi sẽ gửi thông tin cho bạn sớm nhất.<\/div >'},$(".field-validation-error, field-validation-valid").each(function(){t+=$(this).html();t.replace("undefined","")}),u=t.length,u===0&&(cm.ShowDialog(r),$(".close").click(function(){cm.ModalEvent($("#dialogPopup"),"hide")})),$("input").blur(function(){var n=$(this).attr("name");$('.field-validation-error[data-valmsg-for="'+n+'"]').html("")}))}function c(n,t,r){var u={classClose:"fancybox-item fancybox-close new2019",classContent:"new2019",classHeader:"newsletter-register new2019",classFooter:"col center new2019",title:'<div class="news-text"><div class="logo"><a rel="nofollow" href="https://batdongsan.com.vn"><img alt="Kênh thông tin mua bán, cho thuê nhà đất số 1" src=" '+i+'/images/logo-enews1.jpg"><\/a><\/div><\/div> <div class="clear">&nbsp;<\/div>',width:660,url:f+"/Systems/RegisterNewsLetter/Register",type:"GET",data:{email:n,name:t,mobile:r},buttons:[{text:"Đăng ký",id:"btnRegister","class":"btn-register",eventHandle:function(){$("#formSubmitRegister").submit()}},{text:"Hủy",id:"btnCancel","class":"btn-cancel",eventHandle:function(){cm.ModalEvent($("#dialogPopup"),"hide")}}]};cm.ShowDialog(u)}function e(n){var t={type:"GET",url:f+"/Systems/RegisterNewsLetter/IsDuplicateEmail",data:{email:n},success:function(n){n===!0?($('span[data-valmsg-for="Email"]').removeClass(),$('span[data-valmsg-for="Email"]').addClass("field-validation-error"),$('span[data-valmsg-for="Email"]').html("Email của bạn đã tồn tại trong danh sách đăng ký nhận tin từ Batdongsan.com.vn")):($('span[data-valmsg-for="Email"]').removeClass(),$('span[data-valmsg-for="Email"]').addClass("field-validation-valid"),$('span[data-valmsg-for="Email"]').html(""))}};cm.AjaxWrapper(t)}var r="",u="",n="",f="",t="",i="https://file4.batdongsan.com.vn";return i=$("#staticDomain").data("fileimg")!==undefined?$("#staticDomain").data("fileimg"):i,f=$("#staticDomain").data("msvrouter")!==undefined?$("#staticDomain").data("msvrouter"):"",{InitializeLoad:o,Initialize:s,ResultFormRegister:h}}})(newsLetterRegister);