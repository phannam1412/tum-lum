function isIE(){var a=navigator.userAgent.toLowerCase();return(a.indexOf("msie")!=-1)?parseInt(a.split("msie")[1]):false}try{document.domain=window.location.host}catch(ex){}var arrPosition=[];$(document).ready(function(){if(isIE()=="6"){$("#wrap-comment").css("display","none")}var a="";if(window.location.pathname.startsWith("/ban-do-")==false){a+="BANNER_POSITION_BACKGROUND";if(window.location.pathname!="/"){a+="@BANNER_POSITION_FLOADING_BOTTOM"}}var b=-1;$(".adPosition").each(function(){var c=$(this);var d=c.attr("positioncode");if(a.length>0){a+="@"}if(c.attr("hasshare")!=undefined&&c.attr("hasnotshare")!=undefined){a+=c.attr("hasshare")+"$"+c.attr("hasnotshare")+"$"+d}else{a+=d}});if(a.length>0){$.getJSON("/HandlerWeb/BannerHandler.ashx",{cateId:__bannerContext.cateId,pageId:__bannerContext.pageId,currentPage:__bannerContext.currentPage,cityCode:__bannerContext.cityCode,districtId:__bannerContext.districtId,position:a},function(e){if(e!=undefined&&e!=null&&e.lst.length>0){var y=[];var g=false;var h=false;var f=false;for(var m=0;m<e.lst.length;m++){if(e.lst[m].position=="BANNER_POSITION_WIDE_LEFT"){g=true}if(e.lst[m].position=="BANNER_POSITION_WIDE_RIGHT"){h=true}if(e.lst[m].position=="BANNER_POSITION_BACKGROUND"){f=true}}for(var m=0;m<e.lst.length;m++){if(e.lst[m].position=="BANNER_POSITION_LEFT"&&(g||f)){continue}if(e.lst[m].position=="BANNER_POSITION_RIGHT"&&(h||f)){continue}if(e.lst[m].position=="BANNER_POSITION_WIDE_LEFT"&&f){continue}if(e.lst[m].position=="BANNER_POSITION_WIDE_RIGHT"&&f){continue}if(e.lst[m].position=="BANNER_POSITION_FLOATING_BOTTOM"&&window.location.pathname=="/"){continue}y.push(e.lst[m])}e.lst=y;for(var m=0;m<e.lst.length;m++){var u=e.lst[m];var t=$(".adPosition[positioncode="+u.position+"]");var o=u.position=="BANNER_POSITION_BACKGROUND";var p=u.position=="BANNER_POSITION_FLOADING_BOTTOM";var v="";if(p||o){v="onetime"}var l="";var x=t.length>0?t.attr("stylex"):undefined;for(var r=0;r<u.banners.length;r++){var q=false;var c=new Array();for(var s=0;s<u.banners[r].items.length;s++){c[s]=s}for(s=0;s<u.banners[r].items.length;s++){var d=u.banners[r].items[c[s]];if(d.isShare&&q==false){q=true;l+='<div class="adshared" rt="'+v+'">'}if(d.isShare==false&&q==true){q=false;l+="</div>"}var w=d.Src;if(w.indexOf("http://")==0){w="http://"+w.substring("http://".length)}if(q){l+='<div class="adshareditem aditem" time="'+d.TimeToLive+'" style="'+(x!=undefined?x:"")+'; display:none;" src="'+w+'" altsrc="'+d.AltSrc+'" link="'+d.LinkUrl+'" bid="'+d.BannerId+'" tip="'+d.Tooltip+'" tp="'+d.BannerTypeId+'" w="'+d.Width+'" h="'+d.Height+'" isbg="'+o+'" clr="'+p+'"></div>'}else{l+='<div class="aditem" time="'+d.TimeToLive+'" style="'+(x!=undefined?x:"")+'" src="'+w+'" altsrc="'+d.AltSrc+'" link="'+d.LinkUrl+'" bid="'+d.BannerId+'" tip="'+d.Tooltip+'" tp="'+d.BannerTypeId+'" w="'+d.Width+'" h="'+d.Height+'" isbg="'+o+'" clr="'+p+'"></div>'}if(s==u.banners[r].items.length-1&&q==true){l+="</div>"}}}if(t.length>0){t.append(l)}else{if(u.position=="BANNER_POSITION_FLOADING_BOTTOM"){$("body").append('<div class="banner_floading_bottom">'+l+"</div>")}else{if(u.position=="BANNER_POSITION_BACKGROUND"){$("form").prepend('<div class="banner_background">'+l+"</div>")}}}}if(f){$("body").append('<a href="#" id="banner_bg_left" target="_blank"></a><a href="#" id="banner_bg_right" target="_blank"></a>')}}if($("div[positioncode=BANNER_POSITION_LEFT_MAIN_CONTENT]").children().length==0){$("div[positioncode=BANNER_POSITION_LEFT_MAIN_CONTENT]").remove()}$(".aditem").each(function(){if($(this).children().length==0){var k=_getHtmlAdItem(this);if(k==null){$(this).remove();return}else{if($(this).hasClass("adshareditem")==false){try{$(this).append(k);$(this).show();if($(this).attr("isbg")=="true"){var i=$(this).attr("bid");$("#banner_bg_left").attr("href","/click.aspx?bannerid="+i);$("#banner_bg_right").attr("href","/click.aspx?bannerid="+i)}if($(this).attr("clr")=="true"){$(this).append('<div class="closer">x</div>');$(this).find(".closer").click(function(){$(this).parent().remove()})}}catch(j){console.log(j)}}}}});$(".adshared").each(function(i){if($(this).find(".adshareditem").length>0){arrPosition.push(new AdPosition(this))}});var A="";var z=$(".aditem");for(var m=0;m<z.length;m++){A+=","+$(z[m]).attr("bid")}if(A.length>0&&$("form").attr("statsDomain").length>0&&$("form").attr("statsDomain").length>0){A=A.substring(1);var n=new Image();n.src="https://statistic.batdongsan.com.vn/StatisticServiceLibrary/bannerview/"+A}if($("#ban_left").length==0&&$("#ban_right").length==0&&$("#ban_wide_left").length==0&&$("#ban_wide_right").length==0&&$("#banner_bg_left").length==0&&$("#banner_bg_right").length==0){return}$(window).resize(function(){PositionFixed()});PositionFixed()})}});function PositionFixed(){if($("#banner_bg_left").length>0){var a=1000;var b=($(document).width()-a)/2;$("#banner_bg_left").css("width",b+"px");$("#banner_bg_right").css("width",b+"px");$("#ban_left").remove();$("#ban_right").remove();$("#ban_wide_left").remove();$("#ban_wide_right").remove()}else{_PositionFixed("ban_wide_left","ban_wide_right","ban_wide_scroll");_PositionFixed("ban_left","ban_right","ban_scroll")}}function _PositionFixed(c,d,b){if($("#"+c).length>0||$("#"+d).length>0){if($("#"+c).children().length>0||$("#"+d).children().length){var a=1000;var e=$("#"+c).width();var f=$("#"+d).width();var h=(($(document).width()-a)/2)+a;var g=(($(document).width()-a)/2)-e;if($(document.body).width()<a+e+f){$("."+b).css("display","none");return}else{$("."+b).css("display","block")}g=(($(document.body).width()-0-a)/2)-e-10;$("#"+c).css({top:"0px",position:"fixed",left:g+"px"});$("#"+d).css({top:"0px",position:"fixed",right:g+"px"})}}}function shuffleArray(a){if(a.length>1){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1));var d=a[b];a[b]=a[c];a[c]=d}}return a}var AdPosition=function(a){this._init=function(){this._Position=$(a);this.rotateType=this._Position.attr("rt");this.arrRan=new Array();this.Length=this._Position.children().length;for(var b=0;b<this.Length;b++){this.arrRan[b]=b}this.arrRan=shuffleArray(this.arrRan);this.currRan=-1;this.arrBid=[];this.adItems=this._Position.children();for(var b=0;b<this.adItems.length;b++){this.arrBid.push($(this.adItems[b]).attr("bid"))}this.nextitem()};this.rotate=function(d){var c=this.adItems[this.arrRan[this.currRan]];var e=parseInt($(c).attr("time"))*1000;var b=this;if(d){b.nextitem()}else{setTimeout(function(){b.nextitem()},e)}};this.nextitem=function(){var d=$(this.adItems[this.arrRan[this.currRan]]);_stop(d);this.currRan++;if(this.currRan>=this.arrRan.length){this.currRan=0}var f=$(this.adItems[this.arrRan[this.currRan]]);d.hide();f.show();if(_buldAdItem(f)){_play(f)}else{if(f.attr("clr")=="true"){f.append('<div class="closer">x</div>');var b=this;f.find(".closer").click(function(){$(this).parent().remove();b._init()})}}var e=f.attr("isbg")=="true";var c=f.attr("bid");if(e){$("#banner_bg_left").attr("href","/click.aspx?bannerid="+c);$("#banner_bg_right").attr("href","/click.aspx?bannerid="+c)}if(this._Position.parent().hasClass("banner_floading_bottom")&&f.attr("tp")!="8"){$(".footer-bottom-end").css("padding-bottom",f.height()+"px")}else{$(".footer-bottom-end").css("padding-bottom","30px")}if(this.Length<=1||this.rotateType=="onetime"){return}else{this.rotate()}};this._init()};function _buldAdItem(b){if($(b).children().length>0){return true}var a=_getHtmlAdItem(b);if(a!=null){b.append(a)}return false}function _play(a){var f=$(a).attr("tp");if(f==8){var b=$(a).attr("bid");if($("#fr"+b).length>0){try{var d=document.getElementById("fr"+b).contentWindow.exportRoot;d.gotoAndPlay(1);if(d.ani1!=undefined){d.ani1.play()}if(d.ani2!=undefined){d.ani2.play()}if(d.ani3!=undefined){d.ani3.play()}}catch(c){}}}}function _stop(a){var f=$(a).attr("tp");if(f==8){var b=$(a).attr("bid");if($("#fr"+b).length>0){try{var d=document.getElementById("fr"+b).contentWindow.exportRoot;d.gotoAndStop(1);d.stop();if(d.ani1!=undefined){d.ani1.stop()}if(d.ani2!=undefined){d.ani2.stop()}if(d.ani3!=undefined){d.ani3.stop()}document.getElementById("fr"+b).contentWindow.stage.clear();_clearCanvas(document.getElementById("fr"+b).contentWindow.canvas)}catch(c){}}}}function _clearCanvas(a){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height);var c=a.width;a.width=1;a.width=c}function _getHtmlAdItem(a){var j=$(a).attr("src");var b=$(a).attr("altsrc");var h=$(a).attr("link");var d=$(a).attr("bid");var k=$(a).attr("tip");var l=$(a).attr("tp");var m=$(a).attr("w");var e=$(a).attr("h");var g=$(a).attr("k");var f=$(a).attr("isbg")=="true";if(e=="0"){e="auto"}else{e=e+"px"}$(a).attr("k","");var c="nofollow";var i=null;if(l==6){if(detectmob()){j=b;if(j.indexOf("/file.0.jpg")<0){i='<a href="'+h+'" target="_blank" title="'+k+'" rel="'+c+'" ><img src="'+j+'" style="max-width:100%; height:'+e+'"/></a>'}}else{j=j.replace(".jpg",".swf");i='<object id="obj'+d+'" width="'+m+'px" border="0" height="'+e+'" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"><param value="'+j+'" name="movie"><param value="link=https://batdongsan.com.vn/click.aspx?bannerid='+d+'" name="flashvars"><param value="always" name="AllowScriptAccess"><param value="High" name="quality"><param value="transparent" name="wmode"><embed name="obj'+d+'" width="'+m+'px" height="'+e+'" allowscriptaccess="always" wmode="transparent" loop="true" play="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+j+'" flashvars="link=https://batdongsan.com.vn/click.aspx?bannerid='+d+'"></object>'}}else{if(l==8){if(checkHtml5Support()){i='<iframe src="'+j+"?link=https://batdongsan.com.vn/click.aspx?bannerid="+d+'" id="fr'+d+'" width="100%" height="'+e+'" frameborder="0" scrolling="no" style="overflow:hidden"></iframe>'}else{j=b;if(j.indexOf("/file.0.jpg")<0){i='<a href="'+h+'" target="_blank" title="'+k+'" rel="'+c+'" ><img src="'+j+'" style="max-width:100%; height:'+e+'"/></a>'}}}else{if($(this).parent().attr("positionCode")=="BANNER_POSITION_TOP"){i='<a href="/click.aspx?bannerid='+d+'" target="_blank" title="'+k+'" rel="'+c+'"><img src="'+j+'" style="width: 100%; height:94px;"/></a>'}else{if(f){i='<div style="background-image:url('+j+');"></div>'}else{i='<a href="/click.aspx?bannerid='+d+'" target="_blank" title="'+k+'" rel="'+c+'" ><img src="'+j+'" style="max-width: 100%; height:'+e+';"/></a>'}}}}return i}function detectmob(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}}function checkHtml5Support(){var b=document.createElement("canvas");var a=(b.getContext)?true:false;return a}function GenerateRandom(a){var b=null;var c=Math.floor(Math.random()*a);if(localStorage){b=localStorage.RandomNum}if(b!=null){while(b==c){c=Math.floor(Math.random()*a)}}if(localStorage){localStorage.RandomNum=c}return c}function showBannerFix(){var b=window.location.href;if(b=="https://batdongsan.com.vn/"||b=="https://batdongsan.com.vn/"){var a='<div id="bannerfix">';a+='<div stylex="position:fixed; bottom:0px; right:0px; z-index:100;"><div h="184" w="300" tp="6" tip="" bid="1024" link="" altsrc="https://file1.batdongsan.com.vn/file.0.jpg" src="https://file1.batdongsan.com.vn/file.301818.jpg" style="position: fixed; bottom: 0px; right: 0px; z-index: 100; clip: rect(0px, 300px, 184px, 0px);" time="10" class="aditem"><object id="obj'+bid+'" height="184px" border="0" width="300px" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" bannerid="1024" class="view-count"><param name="movie" value="https://file1.batdongsan.com.vn/file.301818.jpg"><param name="flashvars" value="link=https://batdongsan.com.vn/click.aspx?bannerid=1024"><param name="AllowScriptAccess" value="always"><param name="quality" value="High"><param name="wmode" value="transparent"><embed height="184px" width="300px" name="obj'+bid+'" flashvars="link=https://batdongsan.com.vn/click.aspx?bannerid=1024" src="https://file1.batdongsan.com.vn/file.301818.jpg" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" play="true" loop="true" wmode="transparent" allowscriptaccess="always"></object></div></div>';a+="</div>";$("body").append(a)}}function bannermax(){var b=$("#bannerfix .aditem").attr("w");var a=$("#bannerfix .aditem").attr("h");$("#bannerfix .aditem").css("clip","rect(0px, "+b+"px, "+a+"px, 0px)")}function bannermin(b){var a=isNaN(b)?35:b;var e=$("#bannerfix .aditem").attr("w");var c=$("#bannerfix .aditem").attr("h");var d=c-a;$("#bannerfix .aditem").css("clip","rect( "+d+"px, "+e+"px, "+c+"px, 0px)")}function closeBanner(a){for(var b=0;b<arrPosition.length;b++){var c=arrPosition[b];for(var d=0;d<c.arrBid.length;d++){if(c.arrBid[d]==a){$(".aditem[bid="+a+"]").remove();c._init();return}}}$(".aditem[bid="+a+"]").remove()};